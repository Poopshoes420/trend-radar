<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Trend Radar</title>
    <meta http-equiv="refresh" content="300">
    <style>
      body { font-family: Arial, sans-serif; margin: 40px; }
      h1 { margin-bottom: 8px; }
      .meta { color:#666; margin-bottom: 20px; }
      li { margin-bottom: 12px; }
      .sources { color:#444; font-size: 0.9em; }
      .why { color:#666; font-size: 0.95em; }
    </style>
  </head>
  <body>
    <h1>Trend Radar</h1>
    <div class="meta">Auto-refreshes every 5 minutes</div>
    <ol id="list">Loadingâ€¦</ol>

    <script>
  const ENDPOINT = "https://poopshoes420.github.io/trend-radar/data/trends.json";

  fetch(ENDPOINT, { cache: "no-store" })
    .then(response => response.text())
    .then(text => {
      // If GitHub Pages ever returns HTML, stop gracefully
      if (text.trim().startsWith("<")) {
        throw new Error("Received HTML instead of JSON");
      }

      const items = JSON.parse(text);
      const list = document.getElementById("list");

      list.innerHTML = items.map(t => {
        const title = t.topic || "Untitled";
        const url = t.exampleUrl || "#";
        const sources = Array.isArray(t.sources) ? t.sources.join(", ") : "reddit";
        const why = t.why || "";

        return `<li>
          <strong><a href="${url}" target="_blank" rel="noopener noreferrer">${title}</a></strong><br>
          <div class="sources">Sources: ${sources}</div>
          <div class="why">${why}</div>
        </li>`;
      }).join("");
    })
    .catch(err => {
      console.error(err);
      document.getElementById("list").innerText =
        "Could not load trends.";
    });
</script>

  </body>
</html>
